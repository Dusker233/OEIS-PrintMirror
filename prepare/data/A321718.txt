{
    "number": 321718,
    "data": "1,1,5,9,44,123,986,5043,45832,366300,3862429,39916803,495023832,6227020803,88549595295,1308012377572,21086922542349,355687428096003,6427700493998229,121645100408832003",
    "name": "Number of coupled non-normal semi-magic rectangles with sum of entries equal to n.",
    "comment": [
        "A coupled non-normal semi-magic rectangle is a nonnegative integer matrix with equal row sums and equal column sums. The common row sum may be different from the common column sum.",
        "Rectangles must be of size k X m where k and m are divisors of n. This implies that a(p) = p! + 3 for p prime since the only allowable rectangles are of sizes 1 X 1, 1 X p, p X 1 and p X p. The 1 X 1 square is [p], the 1 X p and p X 1 rectangles are [1,...,1] and its transpose and the p X p squares are necessarily permutation matrices and there are p! permutation matrices of size p X p. Also, a(n) >= n! + 3 for n > 1. - _Chai Wah Wu_, Jan 15 2019"
    ],
    "link": [
        "Wikipedia, <a href=\"https://en.wikipedia.org/wiki/Magic_square\">Magic square</a>"
    ],
    "formula": [
        "a(p) = p! + 3 for p prime. a(n) >= n! + 3 for n > 1. - _Chai Wah Wu_, Jan 15 2019"
    ],
    "example": [
        "The a(3) = 9 coupled semi-magic rectangles:",
        "  [3] [1 1 1]",
        ".",
        "  [1] [1 0 0] [1 0 0] [0 1 0] [0 1 0] [0 0 1] [0 0 1]",
        "  [1] [0 1 0] [0 0 1] [1 0 0] [0 0 1] [1 0 0] [0 1 0]",
        "  [1] [0 0 1] [0 1 0] [0 0 1] [1 0 0] [0 1 0] [1 0 0]"
    ],
    "mathematica": [
        "prs2mat[prs_]:=Table[Count[prs,{i,j}],{i,Union[First/@prs]},{j,Union[Last/@prs]}];",
        "multsubs[set_,k_]:=If[k==0,{{}},Join@@Table[Prepend[#,set[[i]]]&/@multsubs[Drop[set,i-1],k-1],{i,Length[set]}]];",
        "Table[Length[Select[multsubs[Tuples[Range[n],2],n],And[Union[First/@#]==Range[Max@@First/@#],Union[Last/@#]==Range[Max@@Last/@#],SameQ@@Total/@prs2mat[#],SameQ@@Total/@Transpose[prs2mat[#]]]&]],{n,5}]"
    ],
    "xref": [
        "Cf. A006052, A120733, A271103, A319056, A321654.",
        "Cf. A321717, A321719, A321720, A321721, A321722, A321724, A321724."
    ],
    "keyword": "nonn,more",
    "offset": "0,3",
    "author": "_Gus Wiseman_, Nov 18 2018",
    "ext": [
        "a(7)-a(15) from _Chai Wah Wu_, Jan 15 2019",
        "a(16)-a(19) from _Chai Wah Wu_, Jan 16 2019"
    ],
    "references": 13,
    "revision": 15,
    "time": "2019-01-16T19:42:58-05:00",
    "created": "2018-11-18T20:43:45-05:00"
}