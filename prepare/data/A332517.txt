{
    "number": 332517,
    "data": "1,5,29,274,3129,47515,823549,16843268,387459861,10009769725,285311670621,8918311856102,302875106592265,11112685048729175,437893951473411261,18447025557276459016,827240261886336764193,39346558373052524325225,1978419655660313589123997",
    "name": "a(n) = Sum_{k=1..n} gcd(n,k)^n.",
    "comment": [
        "If n is prime, a(n) = n-1 + n^n. - _Robert Israel_, Feb 16 2020"
    ],
    "link": [
        "Robert Israel, <a href=\"/A332517/b332517.txt\">Table of n, a(n) for n = 1..386</a>"
    ],
    "formula": [
        "a(n) = Sum_{d|n} phi(n/d) * d^n.",
        "a(n) = Sum_{d|n} mu(n/d) * d * sigma_(n-1)(d).",
        "a(n) ~ n^n.",
        "From _Richard L. Ollerton_, May 09 2021: (Start)",
        "a(n) = Sum_{k=1..n} (n/gcd(n,k))^n*phi(gcd(n,k))/phi(n/gcd(n,k)).",
        "a(n) = Sum_{k=1..n} mu(n/gcd(n,k))*gcd(n,k)*sigma_(n-1)(gcd(n,k))/phi(n/gcd(n,k)). (End)"
    ],
    "maple": [
        "f:= n -> add(igcd(n,k)^n,k=1..n):",
        "map(f, [$1..30]); # _Robert Israel_, Feb 16 2020"
    ],
    "mathematica": [
        "Table[Sum[GCD[n, k]^n, {k, 1, n}], {n, 1, 19}]",
        "Table[Sum[EulerPhi[n/d] d^n, {d, Divisors[n]}], {n, 1, 19}]",
        "Table[Sum[MoebiusMu[n/d] d DivisorSigma[n - 1, d], {d, Divisors[n]}], {n, 1, 19}]"
    ],
    "program": [
        "(PARI) a(n) = sum(k=1, n, gcd(n, k)^n); \\\\ _Michel Marcus_, Feb 14 2020",
        "(Magma) [&+[Gcd(n,k)^n:k in [1..n]]: n in [1..20]]; // _Marius A. Burtea_, Feb 15 2020",
        "(Python)",
        "from sympy import totient, divisors",
        "def A332517(n):",
        "    return sum(totient(d)*(n//d)**n for d in divisors(n,generator=True)) # _Chai Wah Wu_, Feb 15 2020"
    ],
    "xref": [
        "Cf. A000010, A008683, A018804, A031971, A069097, A226561, A228640, A321294."
    ],
    "keyword": "nonn",
    "offset": "1,2",
    "author": "_Ilya Gutkovskiy_, Feb 14 2020",
    "references": 16,
    "revision": 36,
    "time": "2022-09-08T08:46:25-04:00",
    "created": "2020-02-15T14:32:29-05:00"
}