{
    "number": 147562,
    "data": "0,1,5,9,21,25,37,49,85,89,101,113,149,161,197,233,341,345,357,369,405,417,453,489,597,609,645,681,789,825,933,1041,1365,1369,1381,1393,1429,1441,1477,1513,1621,1633,1669,1705,1813,1849,1957,2065,2389,2401,2437,2473",
    "name": "Number of \"ON\" cells at n-th stage in the \"Ulam-Warburton\" two-dimensional cellular automaton.",
    "comment": [
        "Studied by Holladay and Ulam circa 1960. See Fig. 1 and Example 1 of the Ulam reference. - _N. J. A. Sloane_, Aug 02 2009.",
        "Singmaster calls this the Ulam-Warburton cellular automaton. - _N. J. A. Sloane_, Aug 05 2009",
        "On the infinite square grid, start with all cells OFF.",
        "Turn a single cell to the ON state.",
        "At each subsequent step, each cell with exactly one neighbor ON is turned ON, and everything that is already ON remains ON.",
        "Here \"neighbor\" refers to the four adjacent cells in the X and Y directions.",
        "Note that \"neighbor\" could equally well refer to the four adjacent cells in the diagonal directions, since the graph formed by Z^2 with \"one-step rook\" adjacencies is isomorphic to Z^2 with \"one-step bishop\" adjacencies.",
        "Also toothpick sequence starting with a central X-toothpick followed by T-toothpicks (see A160170 and A160172). The sequence gives the number of polytoothpicks in the structure after n-th stage. - _Omar E. Pol_, Mar 28 2011",
        "It appears that this sequence shares infinitely many terms with both A162795 and A169707, see Formula section and Example section. - _Omar E. Pol_, Feb 20 2015",
        "It appears that the positive terms are also the odd terms (a bisection) of A151920. - _Omar E. Pol_, Mar 06 2015",
        "Also, the number of active (ON,black) cells in the n-th stage of growth of two-dimensional cellular automaton defined by Wolfram's \"Rule 558\" or \"Rule 686\" based on the 5-celled von Neumann neighborhood. - _Robert Price_, May 10 2016",
        "From _Omar E. Pol_, Mar 05 2019: (Start)",
        "a(n) is also the total number of \"hidden crosses\" after 4*n stages in the toothpick structure of A139250, including the central cross, beginning to count the crosses when their nuclei are totally formed with 4 quadrilaterals.",
        "a(n) is also the total number of \"flowers with six petals\" after 4*n stages in the toothpick structure of A323650.",
        "Note that the location of the \"nuclei of the hidden crosses\" and the \"flowers with six petals\" in both toothpick structures is essentially the same as the location of the \"ON\" cells in the version \"one-step bishop\" of this sequence (see the illustration of initial terms, figure 2). (End)",
        "This sequence has almost exactly the same graph as A187220, A162795, A169707 and A160164 which is twice A139250. - _Omar E. Pol_, Jun 18 2022"
    ],
    "reference": [
        "S. Ulam, On some mathematical problems connected with patterns of growth of figures, pp. 215-224 of R. E. Bellman, ed., Mathematical Problems in the Biological Sciences, Proc. Sympos. Applied Math., Vol. 14, Amer. Math. Soc., 1962.",
        "S. Wolfram, A New Kind of Science, Wolfram Media, 2002; p. 928."
    ],
    "link": [
        "N. J. A. Sloane, <a href=\"/A147562/b147562.txt\">Table of n, a(n) for n = 0..10000</a>",
        "David Applegate, <a href=\"/A139250/a139250.anim.html\">The movie version</a>",
        "David Applegate, Omar E. Pol and N. J. A. Sloane, <a href=\"/A000695/a000695_1.pdf\">The Toothpick Sequence and Other Sequences from Cellular Automata</a>, Congressus Numerantium, Vol. 206 (2010), 157-191. [There is a typo in Theorem 6: (13) should read u(n) = 4.3^(wt(n-1)-1) for n >= 2.]",
        "Steven R. Finch, <a href=\"/A139250/a139250_1.pdf\">Toothpicks and Live Cells</a>, July 21, 2015. [Cached copy, with permission of the author]",
        "Hsien-Kuei Hwang, Svante Janson, and Tsung-Hsi Tsai, <a href=\"https://arxiv.org/abs/2210.10968\">Identities and periodic oscillations of divide-and-conquer recurrences splitting at half</a>, arXiv:2210.10968 [cs.DS], 2022, p. 31.",
        "Bradley Klee, <a href=\"/A147562/a147562_1.png\">Log-periodic coloring of the first quadrant, over the chair tiling</a>.",
        "Omar E. Pol, <a href=\"http://www.polprimos.com/imagenespub/polca003.jpg\">Illustration of initial terms (Fig. 1: one-step rook - the current sequence)</a>, <a href=\"http://www.polprimos.com/imagenespub/polca005.jpg\">(Fig. 2: one-step bishop)</a>, <a href=\"http://www.polprimos.com/imagenespub/polca007.jpg\">(Fig. 3: overlapping squares)</a>, <a href=\"http://www.polprimos.com/imagenespub/polca009.jpg\">(Fig. 4: overlapping X-toothpicks)</a>, (2009), <a href=\"http://www.polprimos.com/imagenespub/polca033.jpg\">(Fig. 5: overlapping circles)</a>, (2010)",
        "Omar E. Pol, <a href=\"http://www.polprimos.com/imagenespub/polca001.jpg\">Illustration of initial terms of A139250, A160120, A147562 (overlapping figures)</a>, (2009).",
        "David Singmaster, <a href=\"https://m500.org.uk/wp-content/uploads/2016/04/M195WEB.pdf\">On the cellular automaton of Ulam and Warburton</a>, M500 Magazine of the Open University, #195 (December 2003), pp. 2-7.  Also <a href=\"/A079314/a079314.pdf\">scanned annotated cached copy</a>, included with permission.",
        "N. J. A. Sloane, <a href=\"/A147562/a147562.png\">Illustration of terms 0 through 9</a>",
        "N. J. A. Sloane, <a href=\"/wiki/Catalog_of_Toothpick_and_CA_Sequences_in_OEIS\">Catalog of Toothpick and Cellular Automata Sequences in the OEIS</a>",
        "N. J. A. Sloane, <a href=\"http://arxiv.org/abs/1503.01168\">On the Number of ON Cells in Cellular Automata</a>, arXiv:1503.01168 [math.CO], 2015.",
        "N. J. A. Sloane, <a href=\"https://www.youtube.com/watch?v=9ogbsh8KuEM\">Exciting Number Sequences</a> (video of talk), Mar 05 2021",
        "N. J. A. Sloane and Brady Haran, <a href=\"https://www.youtube.com/watch?v=_UtCli1SgjI\">Terrific Toothpick Patterns</a>, Numberphile video (2018).",
        "Mike Warburton, <a href=\"https://arxiv.org/abs/1901.10565\">Ulam-Warburton Automaton - Counting Cells with Quadratics</a>, arXiv:1901.10565 [math.CO], 2019.",
        "Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/ElementaryCellularAutomaton.html\">Elementary Cellular Automaton</a>",
        "S. Wolfram, <a href=\"http://wolframscience.com/\">A New Kind of Science</a>",
        "<a href=\"/index/Ce#cell\">Index entries for sequences related to cellular automata</a>",
        "<a href=\"https://oeis.org/wiki/Index_to_2D_5-Neighbor_Cellular_Automata\">Index to 2D 5-Neighbor Cellular Automata</a>",
        "<a href=\"https://oeis.org/wiki/Index_to_Elementary_Cellular_Automata\">Index to Elementary Cellular Automata</a>"
    ],
    "formula": [
        "a(n) = 1 + 4*Sum_{k=1..n-1} 3^(wt(k)-1) for n>1, where wt() = A000120(). [Corrected by _Paolo Xausa_, Aug 12 2022]",
        "For asymptotics see the discussion in the comments in A006046. - _N. J. A. Sloane_, Mar 11 2021",
        "From _Omar E. Pol_, Mar 13 2011: (Start)",
        "a(n) = 2*A151917(n) - 1, for n >= 1.",
        "a(n) = 1 + 4*A151920(n-2), for n >= 2.",
        "(End)",
        "It appears that a(n) = A162795(n) = A169707(n), if n is a member of A048645, otherwise a(n) < A162795(n) < A169707(n). - _Omar E. Pol_, Feb 20 2015",
        "It appears that a(n) = A151920(2n-2), n >= 1. - _Omar E. Pol_, Mar 06 2015",
        "It appears that a(n) = (A130665(2n-1) - 1)/3, n >= 1. - _Omar E. Pol_, Mar 07 2015",
        "a(n) = 1 + 4*(A130665(n-1) - 1)/3, n >= 1. _Omar E. Pol_, Mar 07 2015",
        "a(n) = A323650(2n)/3. - _Omar E. Pol_, Mar 04 2019"
    ],
    "example": [
        "If we label the generations of cells turned ON by consecutive numbers we get a rosetta cell pattern:",
        ". . . . . . . . . . . . . . . . .",
        ". . . . . . . . 4 . . . . . . . .",
        ". . . . . . . 4 3 4 . . . . . . .",
        ". . . . . . 4 . 2 . 4 . . . . . .",
        ". . . . . 4 3 2 1 2 3 4 . . . . .",
        ". . . . . . 4 . 2 . 4 . . . . . .",
        ". . . . . . . 4 3 4 . . . . . . .",
        ". . . . . . . . 4 . . . . . . . .",
        ". . . . . . . . . . . . . . . . .",
        "In the first generation, only the central \"1\" is ON, a(1)=1. In the next generation, we turn ON four \"2\", leading to a(2)=a(1)+4=5. In the third generation, four \"3\" are turned ON, a(3)=a(2)+4=9. In the fourth generation, each of the four wings allows three 4's to be turned ON, a(4)=a(3)+4*3=21.",
        "From _Omar E. Pol_, Feb 18 2015: (Start)",
        "Also, written as an irregular triangle T(j,k), j>=0, k>=1, in which the row lengths are the terms of A011782:",
        "1;",
        "5;",
        "9,   21;",
        "25,  37, 49, 85;",
        "89, 101,113,149,161,197,233,341;",
        "345,357,369,405,417,453,489,597,609,645,681,789,825,933,1041,1365;",
        "...",
        "The right border gives the positive terms of A002450.",
        "(End)",
        "It appears that T(j,k) = A162795(j,k) = A169707(j,k), if k is a power of 2, for example: it appears that the three mentioned triangles only share the elements from the columns 1, 2, 4, 8, 16, ... - _Omar E. Pol_, Feb 20 2015"
    ],
    "maple": [
        "Since this is the partial sum sequence of A147582, it is most easily obtained using the Maple code given in A147582.",
        "# [x,y] coordinates of cells on",
        "Lse := [[0,0]] ;",
        "# enclosing rectangle of the cells on (that is, minima and maxima in Lse)",
        "xmin := 0 ;",
        "xmax := 0 ;",
        "ymin := 0 ;",
        "ymax := 0 ;",
        "# count neighbors of x,y which are on; return 0 if [x,y] is in L",
        "cntnei := proc(x,y,L)",
        "local a,p,xpt,ypt;",
        "a := 0 ;",
        "if not [x,y] in L then",
        "for p in Lse do",
        "xpt := op(1,p) ;",
        "ypt := op(2,p) ;",
        "if ( abs(xpt-x) = 1 and ypt=y ) or ( x=xpt and abs(ypt-y) = 1) then",
        "a := a+1 ;",
        "fi;",
        "od:",
        "fi:",
        "RETURN(a) ;",
        "end:",
        "# loop over generations/steps",
        "for stp from 1 to 10 do",
        "Lnew := [] ;",
        "for x from xmin-1 to xmax+1 do",
        "for y from ymin-1 to ymax+1 do",
        "if cntnei(x,y,Lse) = 1 then",
        "Lnew := [op(Lnew),[x,y]] ;",
        "fi;",
        "od:",
        "od:",
        "for p in Lnew do",
        "xpt := op(1,p) ;",
        "ypt := op(2,p) ;",
        "xmin := min(xmin,xpt) ;",
        "xmax := max(xmax,xpt) ;",
        "ymin := min(ymin,ypt) ;",
        "ymax := max(ymax,ypt) ;",
        "od:",
        "Lse := [op(Lse),op(Lnew)] ;",
        "print(nops(Lse)) ;"
    ],
    "mathematica": [
        "Join[{0},Map[Function[Apply[Plus,Flatten[ #1]]],CellularAutomaton[{686,{2,{{0,2,0},{2,1,2},{0,2,0}}},{1,1}},{{{1}},0},200]]] (* _Nadia Heninger_ and _N. J. A. Sloane_, Aug 11 2009; modified by _Paolo Xausa_, Aug 12 2022 to include the a(0) term *)",
        "ArrayPlot /@ CellularAutomaton[{686, {2, {{0, 2, 0}, {2, 1, 2}, {0, 2, 0}}}, {1, 1}}, {{{1}}, 0}, 16] (* _N. J. A. Sloane_, Nov 08 2014 *)",
        "A147562list[nmax_]:=Accumulate[Join[{0,1},4*3^(DigitCount[Range[nmax-1],2,1]-1)]];A147562list[100] (* _Paolo Xausa_, May 21 2023 *)"
    ],
    "program": [
        "(PARI) a(n) = if (n, 1 + 4*sum(k=1, n-1, 3^(hammingweight(k)-1)), 0); \\\\ _Michel Marcus_, Jul 05 2022"
    ],
    "xref": [
        "Cf. A000120, A139250, A147582 (number turned ON at n-th step), A147610, A130665, A151920, A151917, A160120, A160164, A160410, A160414, A162795, A169707, A187220, A246331, A323650.",
        "See also A006046, A335794, A335795."
    ],
    "keyword": "nonn,nice",
    "offset": "0,3",
    "author": "_N. J. A. Sloane_, based on emails from _Franklin T. Adams-Watters_, _R. J. Mathar_ and _David W. Wilson_, Apr 29 2009",
    "ext": [
        "Offset and initial terms changed by _N. J. A. Sloane_, Jun 07 2009",
        "Numbers in the comment adapted to the offset by _R. J. Mathar_, Mar 03 2010"
    ],
    "references": 91,
    "revision": 177,
    "time": "2023-05-28T11:31:41-04:00",
    "created": "2010-06-01T03:00:00-04:00"
}