{
    "number": 2997,
    "id": "M5462",
    "data": "561,1105,1729,2465,2821,6601,8911,10585,15841,29341,41041,46657,52633,62745,63973,75361,101101,115921,126217,162401,172081,188461,252601,278545,294409,314821,334153,340561,399001,410041,449065,488881,512461",
    "name": "Carmichael numbers: composite numbers n such that a^(n-1) == 1 (mod n) for every a coprime to n.",
    "comment": [
        "V. \u0160imerka found the first 7 terms of this sequence 25 years before Carmichael (see the link and also the remark of K. Conrad). - _Peter Luschny_, Apr 01 2019",
        "n is composite and squarefree and for p prime, p|n => p-1|n-1.",
        "An odd composite number n is a pseudoprime to base a iff a^(n-1) == 1 mod n. A Carmichael number is an odd composite number n which is a pseudoprime to base a for every number a prime to n.",
        "A composite odd number n is a Carmichael number if and only if n is squarefree and p-1 divides n-1 for every prime p dividing n. (Korselt, 1899)",
        "Ghatage and Scott prove using Fermat's little theorem that (a+b)^n == a^n + b^n (mod n) (the freshman's dream) exactly when n is a prime (A000040) or a Carmichael number. - _Jonathan Vos Post_, Aug 31 2005",
        "Alford et al. have constructed a Carmichael number with 10333229505 prime factors, and have also constructed Carmichael numbers with k prime factors for every k between 3 and 19565220. - _Jonathan Vos Post_, Apr 01 2012",
        "Thomas Wright proved that for any numbers b and M in N with gcd(b,M) = 1, there are infinitely many Carmichael numbers m such that m = b mod M. - _Jonathan Vos Post_, Dec 27 2012",
        "Composite numbers n relatively prime to 1^(n-1)+2^(n-1)+...+(n-1)^(n-1). - _Thomas Ordowski_, Oct 09 2013",
        "Composite numbers n such that A063994(n) = A000010(n). - _Thomas Ordowski_, Dec 17 2013",
        "Odd composite numbers n such that n divides A002445((n-1)/2). - _Robert Israel_, Oct 02 2015",
        "If n is a Carmichael number and gcd(b-1,n)=1, then (b^n-1)/(b-1) is a pseudoprime to base b; by Steuerwald's theorem, see the reference in A005935. - _Thomas Ordowski_, Apr 17 2016",
        "Composite numbers n such that p^n == p (mod n) for every prime p <= A285512(n). - _Max Alekseyev_ and _Thomas Ordowski_, Apr 20 2017",
        "If a composite m < A285549(n) and p^m == p (mod m) for every prime p <= prime(n), then m is a Carmichael number. - _Thomas Ordowski_, Apr 23 2017",
        "The sequence of all Carmichael numbers can be defined as follows: a(1) = 561, a(n+1) = smallest composite k > a(n) such that p^k == p (mod k) for every prime p <= n+2. - _Thomas Ordowski_, Apr 24 2017",
        "An integer m > 1 is a Carmichael number if and only if m is squarefree and each of its prime divisors p satisfies both s_p(m) >= p and s_p(m) == 1 (mod p-1), where s_p(m) is the sum of the base p digits of m. Then m is odd and has at least three prime factors. For each prime factor p, the sharp bound p <= a*sqrt(m) holds with a = sqrt(17/33) = 0.7177.... See Kellner and Sondow 2019. - _Bernd C. Kellner_ and _Jonathan Sondow_, Mar 03 2019",
        "Carmichael numbers are special polygonal numbers A324973. The rank of the n-th Carmichael number is A324975(n). See Kellner and Sondow 2019. - _Jonathan Sondow_, Mar 26 2019",
        "An odd composite number m is a Carmichael number iff m divides denominator(Bernoulli(m-1)). The quotient is A324977. See Pomerance, Selfridge, & Wagstaff, p. 1006, and Kellner & Sondow, section on Bernoulli numbers. - _Jonathan Sondow_, Mar 28 2019",
        "This is setwise difference A324050 \\ A008578. Many of the same identities apply also to A324050. - _Antti Karttunen_, Apr 22 2019",
        "If n is a Carmichael number, then A309132(n) = A326690(n). The proof generalizes that of Theorem in A309132. - _Jonathan Sondow_, Jul 19 2019",
        "Composite numbers n such that A111076(n)^(n-1) == 1 (mod n). Proof: the multiplicative order of A111076(n) mod n is equal to lambda(n), where lambda(n) = A002322(n), so lambda(n) divides n-1, qed. - _Thomas Ordowski_, Nov 14 2019",
        "For all positive integers n, n^k - n is divisible by k, for all k>1, iff k is either a Carmichael number or a prime, as is used in the proof by induction for Fermat's Little Theorem. Also related are A182816 and A121707. - _Richard R. Forberg_, Jul 18 2020",
        "Named by Beeger (1950) after the American mathematician Robert Daniel Carmichael (1879 - 1967). - _Amiram Eldar_, Dec 04 2020",
        "For ending digit 1,3,5,7,9 through the first 10000 terms, we see 80.3, 4.1, 7.4, 3.8 and 4.3% apportionment respectively. Why the bias towards ending digit \"1\"? - _Bill McEachen_, Jul 16 2021",
        "It seems that for any k > 1, the remainders of Carmichael numbers modulo k are biased towards 1. The number of terms congruent to 1 modulo 4, 6, 8, ..., 24 among the first 10000 terms: 9827, 9854, 8652, 8034, 9682, 5685, 6798, 7820, 7880, 3378 and 8518. - _Jianing Song_, Nov 08 2021",
        "Alford, Granville and Pomerance conjectured in their 1994 paper that a statement analogous to Bertrand's Postulate could be applied to Carmichael numbers. This has now been proved by Daniel Larsen, see link below. - _David James Sycamore_, Jan 17 2023"
    ],
    "reference": [
        "N. G. W. H. Beeger, On composite numbers n for which a^n == 1 (mod n) for every a prime to n, Scripta Mathematica, Vol. 16 (1950), pp. 133-135.",
        "A. H. Beiler, Recreations in the Theory of Numbers, Dover Publications, Inc. New York, 1966, Table 18, Page 44.",
        "D. M. Burton, Elementary Number Theory, 5th ed., McGraw-Hill, 2002.",
        "CRC Standard Mathematical Tables and Formulae, 30th ed., 1996, p. 87.",
        "R. K. Guy, Unsolved Problems in Number Theory, A13.",
        "O. Ore, Number Theory and Its History, McGraw-Hill, 1948, Reprinted by Dover Publications, 1988, Chapter 14.",
        "P. Poulet, Tables des nombres compos\u00e9s v\u00e9rifiant le th\u00e9or\u00e8me du Fermat pour le module 2 jusqu'\u00e0 100.000.000, Sphinx (Brussels), 8 (1938), 42-45.",
        "W. Sierpi\u0144ski, A Selection of Problems in the Theory of Numbers. Macmillan, NY, 1964, p. 51.",
        "N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence)."
    ],
    "link": [
        "N. J. A. Sloane, <a href=\"/A002997/b002997.txt\">Table of n, a(n) for n = 1..10000</a> (from the Pinch web site mentioned below)",
        "W. R. Alford, Jon Grantham, Steven Hayman and Andrew Shallue, <a href=\"https://doi.org/10.1090/S0025-5718-2013-02737-8\">Constructing Carmichael numbers through improved subset-product algorithms</a>, Mathematics of Computation, Vol. 83, No. 286 (2014), pp. 899-915, <a href=\"http://arxiv.org/abs/1203.6664\">arXiv preprint</a>, arXiv:1203.6664v1 [math.NT], Mar 29 2012.",
        "W. R. Alford, A. Granville and C. Pomerance, <a href=\"http://www.math.dartmouth.edu/~carlp/PDF/paper95.pdf\">There are infinitely many Carmichael numbers</a>, Ann. of Math. (2) 139 (1994), no. 3, 703-722.",
        "W. R. Alford, A. Granville, and C. Pomerance (1994). \"<a href=\"http://www.math.dartmouth.edu/~carlp/PDF/reliable.pdf\">On the difficulty of finding reliable witnesses</a>\". Lecture Notes in Computer Science 877, 1994, pp. 1-16.",
        "Fran\u00e7ois Arnault, <a href=\"http://www.unilim.fr/~laco/perso/francois.arnault/these.ps\">Thesis</a>",
        "Fran\u00e7ois Arnault, <a href=\"http://dx.doi.org/10.1006/jsco.1995.1042\">Constructing Carmichael numbers which are strong pseudoprimes to several bases</a>, Journal of Symbolic Computation, vol. 20, no 2, Aug. 1995, pp. 151-161.",
        "Fran\u00e7ois Arnault, <a href=\"http://dx.doi.org/10.1090/S0025-5718-1995-1260124-2\">Rabin-Miller primality test: Composite numbers which pass it</a>, Mathematics of Computation, vol. 64, no 209, 1995, pp. 355-361.",
        "Fran\u00e7ois Arnault, <a href=\"http://dx.doi.org/10.1090/S0025-5718-97-00836-3\">The Rabin-Monier theorem for Lucas pseudoprimes</a>, Mathematics of Computation, vol. 66, no 218, April 1997, pp. 869-881.",
        "Joerg Arndt, <a href=\"http://www.jjj.de/fxt/#fxtbook\">Matters Computational (The Fxtbook)</a>, p. 786.",
        "Eric Bach and Rex Fernando, <a href=\"https://doi.org/10.1145/2930889.2930911\">Infinitely Many Carmichael Numbers for a Modified Miller-Rabin Prime Test</a>, ISSAC '16: Proceedings of the ACM on International Symposium on Symbolic and Algebraic Computation, July 2016, pp. 47-54, <a href=\"http://arxiv.org/abs/1512.00444\">arXiv preprint</a>, arXiv:1512.00444 [math.NT], 2015.",
        "Sunghan Bae, Su Hu and Min Sha, <a href=\"https://arxiv.org/abs/1809.05432\">On the Carmichael rings, Carmichael ideals and Carmichael polynomials</a>, arXiv:1809.05432 [math.NT], 2018.",
        "Jonathan Bayless and Paul Kinlaw, <a href=\"https://cs.uwaterloo.ca/journals/JIS/VOL20/Bayless/bayless3.html\">Explicit Bounds for the Sum of Reciprocals of Pseudoprimes and Carmichael Numbers</a>, Journal of Integer Sequences, Vol. 20 (2017), Article 17.6.4.",
        "Jens Bernheiden, <a href=\"https://web.archive.org/web/20160328131347/http://www.mathe-schule.de/download/pdf/Primzahl/Carmichaelzahlen.pdf\">Carmichael numbers (Text in German)</a>.",
        "John D. Brillhart, N. J. A. Sloane, and J. D. Swift, <a href=\"/A001567/a001567_2.pdf\">Correspondence, 1972</a>.",
        "Ronald Joseph Burthe, Jr. <a href=\"http://pldml.icm.edu.pl/pldml/element/bwmeta1.element.bwnjournal-article-aav80i4p311bwm\">Upper bounds for least witnesses and generating sets</a>, Acta Arith. 80 (1997), no. 4, 311-326.",
        "C. K. Caldwell, The Prime Glossary, <a href=\"https://t5k.org/glossary/page.php?sort=CarmichaelNumber\">Carmichael number</a>.",
        "Keith Conrad, <a href=\"https://kconrad.math.uconn.edu/blurbs/ugradnumthy/carmichaelkorselt.pdf\">Carmichael numbers and Korselt\u2019s criterion</a>, expository paper (2016), 1-3.",
        "K. A. Draziotis, V. Martidis and S. Tiganourias, <a href=\"https://arxiv.org/abs/2002.07095\">Product Subset Problem: Applications to number theory and cryptography</a>, arXiv:2002.07095 [math.NT], 2020. See also <a href=\"https://doi.org/10.1142/9789811271922_0005\">Chapter 5</a>, Analysis, Cryptography and Information Science, World Scientific (2023), p. 108.",
        "Harvey Dubner, <a href=\"http://www.cs.uwaterloo.ca/journals/JIS/VOL5/Dubner/dubner6.html\">Carmichael Numbers of the form (6m+1)(12m+1)(18m+1)</a>, Journal of Integer Sequences, Vol. 5 (2002) Article 02.2.1.",
        "James Emery, <a href=\"http://www.stem2.org/je/numbertheory.pdf\">Number Theory</a>, 2013.",
        "Jan Feitsma and William Galway, <a href=\"http://www.cecm.sfu.ca/Pseudoprimes/\">Tables of pseudoprimes and related data</a>.",
        "Pratibha Ghatage and Brian Scott, <a href=\"http://www.jstor.org/stable/30044877\">Exactly When is (a+b)^n == a^n + b^n (mod n)?</a>, College Mathematics Journal, Vol. 36, No. 4 (Sep 2005), p. 322.",
        "Andrew Granville, <a href=\"http://www.dms.umontreal.ca/~andrew/agpapers.html\">Papers on Carmichael numbers</a>",
        "Andrew Granville, <a href=\"http://www.dms.umontreal.ca/~andrew/PDF/Notices1.pdf\">Primality testing and Carmichael numbers</a>, Notices Amer. Math. Soc., 39 (No. 7, 1992), 696-700.",
        "Andrew Granville and Carl Pomerance, <a href=\"http://www.math.dartmouth.edu/~carlp/PDF/paper125.pdf\">Two contradictory conjectures concerning Carmichael numbers</a>, Math. Comp. 71 (2002), no. 238, 883-908.",
        "Gerhard Jaeschke, <a href=\"http://dx.doi.org/10.1090/S0025-5718-1990-1023763-5\">The Carmichael numbers to 10^12</a>, Math. Comp., Vol. 55, No. 191 (1990), pp. 383-389.",
        "Eugene Karolinsky and Dmytro Seliutin, <a href=\"https://arxiv.org/abs/2001.10315\">Carmichael numbers for GL(m)</a>, arXiv:2001.10315 [math.NT], 2020.",
        "Bernd C. Kellner, <a href=\"http://math.colgate.edu/~integers/w38/w38.pdf\">On primary Carmichael numbers</a>, Integers 22 (2022), #A38, 39 pp.; arXiv:<a href=\"https://arxiv.org/abs/1902.11283\">1902.11283</a> [math.NT], 2019.",
        "Bernd C. Kellner and Jonathan Sondow, <a href=\"http://math.colgate.edu/~integers/v52/v52.pdf\">On Carmichael and polygonal numbers, Bernoulli polynomials, and sums of base-p digits</a>, Integers 21 (2021), #A52, 21 pp.; arXiv:<a href=\"https://arxiv.org/abs/1902.10672\">1902.10672</a> [math.NT], 2019.",
        "A. Korselt, G. Tarry, I. Franel and G. Vacca, <a href=\"http://oeis.org/wiki/File:Probl%C3%A8me_chinois.pdf\">Probl\u00e8me chinois</a>, L'interm\u00e9diaire des math\u00e9maticiens 6 (1899), 142-144.",
        "Daniel Larsen, <a href=\"https://arxiv.org/abs/2111.06963\">Bertrand's Postulate for Carmichael Numbers</a>, arXiv:2111.06963 [math.NT], 2021.",
        "D. H. Lehmer, <a href=\"https://doi.org/10.1090/S0025-5718-71-99708-0\">Errata for Poulet's table</a>, Math. Comp., 25 (1971), 944-945. 25 944 1971.",
        "Max Lewis and Victor Scharaschkin, <a href=\"https://www.emis.de/journals/INTEGERS/papers/q80/q80.Abstract.html\">k-Lehmer and k-Carmichael Numbers</a>, Integers, 16 (2016), #A80.",
        "Renaud Lifchitz, <a href=\"http://www.primenumbers.net/Renaud/eng/korseltg.pdf\">A generalization of the Korselt's criterion - Nested Carmichael numbers</a>",
        "Romeo Me\u0161trovi\u0107, <a href=\"http://arxiv.org/abs/1305.1867\">Generalizations of Carmichael numbers I,</a> arXiv:1305.1867v1 [math.NT], May 04 2013.",
        "Romeo Me\u0161trovi\u0107, <a href=\"https://cs.uwaterloo.ca/journals/JIS/VOL17/Mestrovic/mes4.html\">On a Congruence Modulo n^3 Involving Two Consecutive Sums of Powers</a>, Journal of Integer Sequences, Vol. 17 (2014), 14.8.4.",
        "Yoshio Mimura, <a href=\"http://www.kobepharma-u.ac.jp/~math/notes/note02.html\">Carmichael Numbers up to 10^12</a>. [broken link, <a href=\"http://web.archive.org/web/20131214001718/http://www.kobepharma-u.ac.jp/~math/notes/note02.html\">WayBackMachine</a>]",
        "Math Reference Project, <a href=\"http://www.mathreference.com/num-mod,ccm.html\">Carmichael Numbers</a>.",
        "R. G. E. Pinch, <a href=\"http://www.s369624816.websitehome.co.uk/rgep/cartable.html\">The Carmichael numbers up to 10^18</a>, 2008.",
        "R. G. E. Pinch, Carmichael numbers up to <a href=\"http://www.chalcedon.demon.co.uk/rgep/publish.html#37\">10^15</a>, <a href=\"http://s369624816.websitehome.co.uk/rgep/carmichael-16.gz\">10^16</a>, <a href=\"http://s369624816.websitehome.co.uk/rgep/carmichael17.gz\">10^16 to 10^17</a>, <a href=\"http://s369624816.websitehome.co.uk/rgep/carmichael18.gz\">10^17 to 10^18</a>, <a href=\"http://www.chalcedon.demon.co.uk/rgep/publish.html#78\">10^19</a>, and <a href=\"http://www.chalcedon.demon.co.uk/rgep/publish.html#82\">10^21</a>",
        "Carl Pomerance, J. L. Selfridge and Samuel S. Wagstaff, Jr., <a href=\"http://dx.doi.org/10.1090/S0025-5718-1980-0572872-7\">The pseudoprimes to 25*10^9</a>, Math. Comp., Vol. 35, No. 151 (1980), pp. 1003-1026.",
        "Carl Pomerance & N. J. A. Sloane, <a href=\"/A001567/a001567_4.pdf\">Correspondence, 1991</a>.",
        "Fred Richman, <a href=\"http://math.fau.edu/Richman/carm.htm\">Primality testing with Fermat's little theorem</a>.",
        "Vladimir Shevelev, <a href=\"http://www.emis.de/journals/INTEGERS/papers/m1/m1.Abstract.html\">The number of permutations with prescribed up-down structure as a function of two variables</a>, INTEGERS, 12 (2012), #A1. - From _N. J. A. Sloane_, Feb 07 2013",
        "V\u00e1clav \u0160imerka, <a href=\"https://dml.cz/handle/10338.dmlcz/122245\">Zbytky z arithmetick\u00e9 posloupnosti</a>, (On the remainders of an arithmetic progression), \u010casopis pro p\u011bstov\u00e1n\u00ed matematiky a fysiky. 14 (1885), 221-225.",
        "Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/CarmichaelNumber.html\">Carmichael Number</a>, <a href=\"http://mathworld.wolfram.com/KnoedelNumbers.html\">Knoedel Numbers</a>, and <a href=\"http://mathworld.wolfram.com/Pseudoprime.html\">Pseudoprime</a>.",
        "Wikipedia, <a href=\"http://www.wikipedia.org/wiki/Carmichael_number\">Carmichael number</a>.",
        "Thomas Wright, <a href=\"https://doi.org/10.1112/blms/bdt013\">Infinitely many Carmichael numbers in arithmetic progressions</a>, Bulletin of the London Mathematical Society, 45 (2013) 943-952, <a href=\"http://arxiv.org/abs/1212.5850\">arXiv preprint</a>, arXiv:1212.5850 [math.NT], Dec 2012.",
        "<a href=\"/index/Ca#Carmichael\">Index entries for sequences related to Carmichael numbers.</a>"
    ],
    "formula": [
        "Sum_{n>=1} 1/a(n) is in the interval (0.004706, 27.8724) (Bayless and Kinlaw, 2017). - _Amiram Eldar_, Oct 26 2020"
    ],
    "maple": [
        "filter:= proc(n)",
        "  local q;",
        "  if isprime(n) then return false fi;",
        "  if 2 &^ (n-1) mod n <> 1 then return false fi;",
        "  if not numtheory:-issqrfree(n) then return false fi;",
        "  for q in numtheory:-factorset(n) do",
        "    if (n-1) mod (q-1) <> 0 then return false fi",
        "  od:",
        "  true;",
        "end proc:",
        "select(filter, [seq(2*k+1,k=1..10^6)]); # _Robert Israel_, Dec 29 2014",
        "isA002997 := n -> 0 = modp(n-1, numtheory:-lambda(n)) and not isprime(n) and n <> 1:",
        "select(isA002997, [$1..10000]); # _Peter Luschny_, Jul 21 2019"
    ],
    "mathematica": [
        "Cases[Range[1,100000,2], n_ /; Mod[n, CarmichaelLambda[n]] == 1 && ! PrimeQ[n]] (* _Artur Jasinski_, Apr 05 2008; minor edit from _Zak Seidov_, Feb 16 2011 *)",
        "Select[Range[1,600001,2],CompositeQ[#]&&Mod[#,CarmichaelLambda[#]]==1&] (* _Harvey P. Dale_, Jul 08 2023 *)"
    ],
    "program": [
        "(PARI) Korselt(n)=my(f=factor(n));for(i=1,#f[,1],if(f[i,2]>1||(n-1)%(f[i,1]-1),return(0)));1",
        "isA002997(n)=n%2 && !isprime(n) && Korselt(n) && n>1 \\\\ _Charles R Greathouse IV_, Jun 10 2011",
        "(PARI) is_A002997(n, F=factor(n)~)={ #F>2 && !foreach(F,f,(n%(f[1]-1)==1 && f[2]==1) || return)} \\\\ No need to check parity: if efficiency is needed, scan only odd numbers. - _M. F. Hasler_, Aug 24 2012, edited Mar 24 2022",
        "(Haskell)",
        "a002997 n = a002997_list !! (n-1)",
        "a002997_list = [x | x <- a024556_list,",
        "all (== 0) $ map ((mod (x - 1)) . (subtract 1)) $ a027748_row x]",
        "-- _Reinhard Zumkeller_, Apr 12 2012",
        "(Magma) [n: n in [3..53*10^4 by 2] | not IsPrime(n) and n mod CarmichaelLambda(n) eq 1]; // _Bruno Berselli_, Apr 23 2012",
        "(Sage)",
        "def isCarmichael(n):",
        "    if n == 1 or is_even(n) or is_prime(n):",
        "        return False",
        "    factors = factor(n)",
        "    for f in factors:",
        "        if f[1] > 1: return False",
        "        if (n - 1) % (f[0] - 1) != 0:",
        "            return False",
        "    return True",
        "print([n for n in (1..20000) if isCarmichael(n)]) # _Peter Luschny_, Apr 02 2019",
        "(Python)",
        "from itertools import islice",
        "from sympy import nextprime, factorint",
        "def A002997_gen(): # generator of terms",
        "    p, q = 3, 5",
        "    while True:",
        "        for n in range(p+2,q,2):",
        "            f = factorint(n)",
        "            if max(f.values()) == 1 and not any((n-1) % (p-1) for p in f):",
        "                yield n",
        "        p, q = q, nextprime(q)",
        "A002997_list = list(islice(A002997_gen(),20)) # _Chai Wah Wu_, May 11 2022"
    ],
    "xref": [
        "Cf. A001567, A002445, A002322, A006931, A024556, A027748, A055553, A064238-A064262, A083737, A087441, A087442, A135717, A141711, A153581, A225498, A285512, A285549, A309132, A324290, A324315, A324316, A324973, A324975, A324977, A326690.",
        "Subsequence of A324050."
    ],
    "keyword": "nonn,nice",
    "offset": "1,1",
    "author": "_N. J. A. Sloane_",
    "ext": [
        "Links for lists of Carmichael numbers updated by _Jan Kristian Haugland_, Mar 25 2009 and _Danny Rorabaugh_, May 05 2017"
    ],
    "references": 332,
    "revision": 380,
    "time": "2023-07-11T13:40:49-04:00",
    "created": "1991-04-30T03:00:00-04:00"
}