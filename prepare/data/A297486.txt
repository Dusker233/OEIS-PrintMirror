{
    "number": 297486,
    "data": "84,2000,205920,39187952,21856506798,32510786132592,124523589644006520",
    "name": "Number of maximal matchings in the n X n torus grid graph.",
    "link": [
        "Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/Matching.html\">Matching</a>",
        "Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/MaximalIndependentEdgeSet.html\">Maximal Independent Edge Set</a>",
        "Eric Weisstein's World of Mathematics, <a href=\"http://mathworld.wolfram.com/TorusGridGraph.html\">Torus Grid Graph</a>"
    ],
    "mathematica": [
        "a[n_] := Module[{maxCycle, addition, basis, compatibleQ},",
        "   maxCycle =",
        "    Select[Tuples[{0, 1}, n],",
        "     And[#*RotateRight[#] == ConstantArray[0, n],",
        "       AllTrue[# + RotateRight[#] + RotateLeft[#], # > 0 &]] &];",
        "   addition[s_] :=",
        "    With[{G =",
        "       RelationGraph[And[#1 != #2, AllTrue[#1 - #2, NonNegative]] &,",
        "        DeleteDuplicates[",
        "         Map[",
        "          ReplacePart[#,",
        "            Map[Rule[#, 0] &,",
        "             Complement[Range[n],",
        "              Flatten[Position[s + RotateLeft[s], 0]]]]] &,",
        "          maxCycle]]]},",
        "     Map[{s, #} &, Pick[VertexList[G], VertexInDegree[G], 0]]",
        "     ];",
        "   basis = Flatten[Map[addition, Tuples[{0, 1, 2}, n]], 1];",
        "   compatibleQ[{s_, t_}, {p_, q_}] :=",
        "    And[Position[s, 2] == Position[p, 1],",
        "     AllTrue[",
        "      t + RotateRight[t] + q + RotateRight[q] + s + p, # > 0 &]];",
        "   Tr[MatrixPower[",
        "     SparseArray[",
        "      Table[",
        "       Boole[compatibleQ[tup1, tup2]], {tup1, basis}, {tup2, basis}]],",
        "      n]]",
        "   ];",
        "Table[a[n], {n, 3, 6}] (* _Pjotr Buys_, Jul 06 2023 *)"
    ],
    "keyword": "nonn,more",
    "offset": "3,1",
    "author": "_Eric W. Weisstein_, Dec 30 2017",
    "ext": [
        "a(6) from _Andrew Howroyd_, Dec 30 2017",
        "a(7) from _Pontus von Br\u00f6mssen_, Dec 31 2022",
        "a(8)-a(9) from _Pjotr Buys_, Jul 06 2023"
    ],
    "references": 0,
    "revision": 15,
    "time": "2023-07-06T03:07:56-04:00",
    "created": "2017-12-30T17:29:40-05:00"
}