{
    "number": 366251,
    "data": "1,3,5,7,9,11,13,17,19,21,23,25,27,29,31,35,37,39,41,43,47,49,53,55,57,59,61,63,65,67,71,73,77,79,81,83,85,89,91,93,95,97,101,103,107,109,111,113,115,117,119,121,125,127,129,131,133,137,139,143,145",
    "name": "Numbers with a coprime divisor shift.",
    "comment": [
        "A number k has a coprime divisor shift s if GCD(d + s, k) = 1 for all divisors d of k.",
        "If k is in the sequence, then all divisors of k are in the sequence too.",
        "From _David A. Corneth_, Oct 06 2023: (Start)",
        "As a consequence of the above, if some m is not in the sequence then any multiple of m is not in the sequence either. So all terms are odd as 2 is not in the sequence.",
        "To see if k is a term we can do the following:",
        "- Check whether k is even; if so then k is not in the sequence.",
        "- Make a list of the divisors of k. Let tau(k) be the number of divisors of k. Then for each prime p <= tau(k) if the number of residues mod p of the divisors of k is equal to p then k is not in the sequence. Otherwise by the Chinese Remainder Theorem we can find a number s such that gcd(d + s, n) = 1 for all d.",
        "So every odd prime is a term. (End)"
    ],
    "link": [
        "M. Farrokhi D. G., <a href=\"/A366251/b366251.txt\">Table of n, a(n) for n = 1..10000</a>"
    ],
    "example": [
        "1 is a term since GCD(1 + 0, 1) = 1.",
        "2 is not a term since GCD(1 + s, 2) > 1 or GCD(2 + s, 2) > 1 for all nonnegative integers s.",
        "3 is a term since GCD(1 + 1, 3) = GCD(3 + 1, 3) = 1."
    ],
    "maple": [
        "aList := proc(len) local isds, findds;",
        "isds := (k, s) -> andmap(d -> igcd(d + s, k) = 1, NumberTheory:-Divisors(k));",
        "findds := k -> ormap(s -> isds(k, s), [seq(1..k)]);",
        "select(k -> findds(k), [seq(1..len)]) end:",
        "aList(133);  # _Peter Luschny_, Oct 06 2023",
        "# More efficient, after _David A. Corneth_:",
        "isa := proc(n) local d, p, t; p := 3;",
        "if irem(n, 2) = 0 then return false fi;",
        "d := NumberTheory:-Divisors(n);",
        "while p < nops(d) do",
        "   {seq(irem(t, p), t = d)};",
        "   if nops(%) = p then return false fi;",
        "   p := nextprime(p);",
        "od: true end:",
        "aList := len -> select(isa, [seq(1..len)]):",
        "aList(145);  # _Peter Luschny_, Oct 07 2023"
    ],
    "program": [
        "(PARI)",
        "isds(k,s)={fordiv(k, d, if(gcd(d+s, k)<>1, return(0))); 1}",
        "findds(k)={for(s=1, k, if(isds(k,s), return(s))); 0}",
        "select(k->findds(k), [1..150]) \\\\ _Andrew Howroyd_, Oct 05 2023",
        "(PARI)",
        "is(n) = {",
        "\tif(!bitand(n, 1), return(0));",
        "\tmy(d = divisors(n));",
        "\tforprime(p = 3, #d,",
        "\t\tif(#Set(d % p) == p,",
        "\t\t\treturn(0)",
        "\t\t)",
        "\t); 1\t",
        "} \\\\ _David A. Corneth_, Oct 06 2023",
        "(GAP)",
        "CoprimeDivisorShift := function(n)",
        "local shift, divisors;",
        "shift := 0;",
        "if not IsPrimeInt(n) and First(PrimeDivisors(n), p -> CoprimeDivisorShift(n / p) = infinity) <> fail then",
        "\tshift := infinity;",
        "fi;",
        "if shift < infinity then",
        "\tdivisors := DivisorsInt(n);",
        "\twhile shift < n and First(divisors, d -> GcdInt(d + shift, n) > 1) <> fail do",
        "\t\tshift := shift + 1;",
        "\tod;",
        "\tif shift = n then",
        "\t\tshift := infinity;",
        "\tfi;",
        "fi;",
        "return shift;",
        "end;"
    ],
    "xref": [
        "Cf. A366219."
    ],
    "keyword": "nonn,easy,new",
    "offset": "1,2",
    "author": "_M. Farrokhi D. G._, Oct 05 2023",
    "references": 0,
    "revision": 38,
    "time": "2023-10-08T04:03:42-04:00",
    "created": "2023-10-07T17:23:49-04:00"
}